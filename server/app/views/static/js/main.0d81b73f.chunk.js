(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{108:function(e,t,n){},228:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n(43),s=n.n(r),c=n(13),i=n(4),o=(n(107),n(14)),l=n(3),u=n(8),d=Object(u.c)({name:"message",initialState:{},reducers:{setMessage:function(e,t){return{message:t.payload}},clearMessage:function(){return{message:""}}}}),j=d.reducer,b=d.actions,m=b.setMessage,p=b.clearMessage,O=j,f=(n(108),{on:function(e,t){document.addEventListener(e,(function(e){return t(e.detail)}))},dispatch:function(e,t){document.dispatchEvent(new CustomEvent(e,{detail:t}))},remove:function(e,t){document.removeEventListener(e,t)}}),h=n(92),g=n.n(h).a.create({baseURL:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_API_BASE_URL||"http://localhost:6868/api",headers:{"Content-type":"application/json"}});function x(){var e=JSON.parse(localStorage.getItem("user"));return e&&e.accessToken?{Authorization:"Bearer "+e.accessToken}:{}}var v,N,w={getPublicContent:function(){return g.get("/all")},getUserBoard:function(){return g.get("/user",{headers:x()})},getModeratorBoard:function(){return g.get("/mod",{headers:x()})},getAdminBoard:function(){return g.get("/admin",{headers:x()})}},S=n(1),k=function(){var e=Object(a.useState)(""),t=Object(i.a)(e,2),n=t[0],r=t[1];return Object(a.useEffect)((function(){w.getAdminBoard().then((function(e){r(e.data)}),(function(e){var t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();r(t),e.response&&401===e.response.status&&f.dispatch("logout")}))}),[]),Object(S.jsx)("div",{className:"container",children:Object(S.jsx)("header",{className:"jumbotron",children:Object(S.jsx)("h3",{children:n})})})},y=function(){var e=Object(a.useState)(""),t=Object(i.a)(e,2),n=t[0],r=t[1];return Object(a.useEffect)((function(){w.getModeratorBoard().then((function(e){r(e.data)}),(function(e){var t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();r(t),e.response&&401===e.response.status&&f.dispatch("logout")}))}),[]),Object(S.jsx)("div",{className:"container",children:Object(S.jsx)("header",{className:"jumbotron",children:Object(S.jsx)("h3",{children:n})})})},T=function(){var e=Object(a.useState)(""),t=Object(i.a)(e,2),n=t[0],r=t[1];return Object(a.useEffect)((function(){w.getUserBoard().then((function(e){r(e.data)}),(function(e){var t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();r(t),e.response&&401===e.response.status&&f.dispatch("logout")}))}),[]),Object(S.jsx)("div",{className:"container",children:Object(S.jsx)("header",{className:"jumbotron",children:Object(S.jsx)("h3",{children:n})})})},E=function(){var e=Object(a.useState)(""),t=Object(i.a)(e,2),n=t[0],r=t[1];return Object(a.useEffect)((function(){w.getPublicContent().then((function(e){r(e.data)}),(function(e){var t=e.response&&e.response.data||e.message||e.toString();r(t)}))}),[]),Object(S.jsx)("div",{className:"container",children:Object(S.jsx)("header",{className:"jumbotron",children:Object(S.jsx)("h3",{children:n})})})},I=n(10),L=n(22),A=n(11),_=n(7),B=n.n(_),R=n(19),C={register:function(e,t,n){return g.post("auth/signup",{username:e,email:t,password:n})},login:function(e,t){return g.post("auth/signin",{username:e,password:t}).then((function(e){return e.data.accessToken&&localStorage.setItem("user",JSON.stringify(e.data)),e.data}))},logout:function(){localStorage.removeItem("user")}},P=JSON.parse(localStorage.getItem("user")),U=Object(u.b)("auth/register",function(){var e=Object(R.a)(B.a.mark((function e(t,n){var a,r,s,c,i;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.username,r=t.email,s=t.password,e.prev=1,e.next=4,C.register(a,r,s);case 4:return c=e.sent,n.dispatch(m(c.data.message)),e.abrupt("return",c.data);case 9:return e.prev=9,e.t0=e.catch(1),i=e.t0.response&&e.t0.response.data&&e.t0.response.data.message||e.t0.message||e.t0.toString(),n.dispatch(m(i)),e.abrupt("return",n.rejectWithValue());case 14:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,n){return e.apply(this,arguments)}}()),q=Object(u.b)("auth/login",function(){var e=Object(R.a)(B.a.mark((function e(t,n){var a,r,s,c;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.username,r=t.password,e.prev=1,e.next=4,C.login(a,r);case 4:return s=e.sent,e.abrupt("return",{user:s});case 8:return e.prev=8,e.t0=e.catch(1),c=e.t0.response&&e.t0.response.data&&e.t0.response.data.message||e.t0.message||e.t0.toString(),n.dispatch(m(c)),e.abrupt("return",n.rejectWithValue());case 13:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,n){return e.apply(this,arguments)}}()),M=Object(u.b)("auth/logout",(function(){C.logout()})),F=P?{isLoggedIn:!0,user:P}:{isLoggedIn:!1,user:null},D=Object(u.c)({name:"auth",initialState:F,extraReducers:(v={},Object(A.a)(v,U.fulfilled,(function(e,t){e.isLoggedIn=!1})),Object(A.a)(v,U.rejected,(function(e,t){e.isLoggedIn=!1})),Object(A.a)(v,q.fulfilled,(function(e,t){e.isLoggedIn=!0,e.user=t.payload.user})),Object(A.a)(v,q.rejected,(function(e,t){e.isLoggedIn=!1,e.user=null})),Object(A.a)(v,M.fulfilled,(function(e,t){e.isLoggedIn=!1,e.user=null})),v)}).reducer,J=function(e){var t=Object(a.useState)(!1),n=Object(i.a)(t,2),r=n[0],s=n[1],o=Object(c.c)((function(e){return e.auth})).isLoggedIn,u=Object(c.c)((function(e){return e.message})).message,d=Object(c.b)();Object(a.useEffect)((function(){d(p())}),[d]);var j=L.a().shape({username:L.b().required("This field is required!"),password:L.b().required("This field is required!")});return o?Object(S.jsx)(l.a,{to:"/profile"}):Object(S.jsxs)("div",{className:"col-md-12 login-form",children:[Object(S.jsxs)("div",{className:"card card-container",children:[Object(S.jsx)("img",{src:"//ssl.gstatic.com/accounts/ui/avatar_2x.png",alt:"profile-img",className:"profile-img-card"}),Object(S.jsx)(I.d,{initialValues:{username:"",password:""},validationSchema:j,onSubmit:function(t){var n=t.username,a=t.password;s(!0),d(q({username:n,password:a})).unwrap().then((function(){e.history.push("/profile"),window.location.reload()})).catch((function(){s(!1)}))},children:Object(S.jsxs)(I.c,{children:[Object(S.jsxs)("div",{className:"form-group",children:[Object(S.jsx)("label",{htmlFor:"username",children:"Username"}),Object(S.jsx)(I.b,{name:"username",type:"text",className:"form-control"}),Object(S.jsx)(I.a,{name:"username",component:"div",className:"alert alert-danger"})]}),Object(S.jsxs)("div",{className:"form-group",children:[Object(S.jsx)("label",{htmlFor:"password",children:"Password"}),Object(S.jsx)(I.b,{name:"password",type:"password",className:"form-control"}),Object(S.jsx)(I.a,{name:"password",component:"div",className:"alert alert-danger"})]}),Object(S.jsx)("div",{className:"form-group",children:Object(S.jsxs)("button",{type:"submit",className:"btn btn-primary btn-block",disabled:r,children:[r&&Object(S.jsx)("span",{className:"spinner-border spinner-border-sm"}),Object(S.jsx)("span",{children:"Login"})]})})]})})]}),u&&Object(S.jsx)("div",{className:"form-group",children:Object(S.jsx)("div",{className:"alert alert-danger",role:"alert",children:u})})]})},V=function(){var e=Object(c.c)((function(e){return e.auth})).user;return e?Object(S.jsxs)("div",{className:"container",children:[Object(S.jsx)("header",{className:"jumbotron",children:Object(S.jsxs)("h3",{children:[Object(S.jsx)("strong",{children:e.username})," Profile"]})}),Object(S.jsxs)("p",{children:[Object(S.jsx)("strong",{children:"Token:"})," ",e.accessToken.substring(0,20)," ..."," ",e.accessToken.substr(e.accessToken.length-20)]}),Object(S.jsxs)("p",{children:[Object(S.jsx)("strong",{children:"Id:"})," ",e.id]}),Object(S.jsxs)("p",{children:[Object(S.jsx)("strong",{children:"Email:"})," ",e.email]}),Object(S.jsx)("strong",{children:"Authorities:"}),Object(S.jsx)("ul",{children:e.roles&&e.roles.map((function(e,t){return Object(S.jsx)("li",{children:e},t)}))})]}):Object(S.jsx)(l.a,{to:"/login"})},W=function(){var e=Object(a.useState)(!1),t=Object(i.a)(e,2),n=t[0],r=t[1],s=Object(c.c)((function(e){return e.message})).message,o=Object(c.b)();Object(a.useEffect)((function(){o(p())}),[o]);var l=L.a().shape({username:L.b().test("len","The username must be between 3 and 20 characters.",(function(e){return e&&e.toString().length>=3&&e.toString().length<=20})).required("This field is required!"),email:L.b().email("This is not a valid email.").required("This field is required!"),password:L.b().test("len","The password must be between 6 and 40 characters.",(function(e){return e&&e.toString().length>=6&&e.toString().length<=40})).required("This field is required!")});return Object(S.jsxs)("div",{className:"col-md-12 signup-form",children:[Object(S.jsxs)("div",{className:"card card-container",children:[Object(S.jsx)("img",{src:"//ssl.gstatic.com/accounts/ui/avatar_2x.png",alt:"profile-img",className:"profile-img-card"}),Object(S.jsx)(I.d,{initialValues:{username:"",email:"",password:""},validationSchema:l,onSubmit:function(e){var t=e.username,n=e.email,a=e.password;r(!1),o(U({username:t,email:n,password:a})).unwrap().then((function(){r(!0)})).catch((function(){r(!1)}))},children:Object(S.jsx)(I.c,{children:!n&&Object(S.jsxs)("div",{children:[Object(S.jsxs)("div",{className:"form-group",children:[Object(S.jsx)("label",{htmlFor:"username",children:"Username"}),Object(S.jsx)(I.b,{name:"username",type:"text",className:"form-control"}),Object(S.jsx)(I.a,{name:"username",component:"div",className:"alert alert-danger"})]}),Object(S.jsxs)("div",{className:"form-group",children:[Object(S.jsx)("label",{htmlFor:"email",children:"Email"}),Object(S.jsx)(I.b,{name:"email",type:"email",className:"form-control"}),Object(S.jsx)(I.a,{name:"email",component:"div",className:"alert alert-danger"})]}),Object(S.jsxs)("div",{className:"form-group",children:[Object(S.jsx)("label",{htmlFor:"password",children:"Password"}),Object(S.jsx)(I.b,{name:"password",type:"password",className:"form-control"}),Object(S.jsx)(I.a,{name:"password",component:"div",className:"alert alert-danger"})]}),Object(S.jsx)("div",{className:"form-group",children:Object(S.jsx)("button",{type:"submit",className:"btn btn-primary btn-block",children:"Sign Up"})})]})})})]}),s&&Object(S.jsx)("div",{className:"form-group",children:Object(S.jsx)("div",{className:n?"alert alert-success":"alert alert-danger",role:"alert",children:s})})]})},H=n(9),K=Object(H.a)(),z=function(){var e=Object(a.useState)(!1),t=Object(i.a)(e,2),n=t[0],r=t[1],s=Object(a.useState)(!1),u=Object(i.a)(s,2),d=u[0],j=u[1],b=Object(c.c)((function(e){return e.auth})).user,m=Object(c.b)();Object(a.useEffect)((function(){K.listen((function(e){m(p())}))}),[m]);var O=Object(a.useCallback)((function(){m(M())}),[m]);return Object(a.useEffect)((function(){return b?(r(b.roles.includes("ROLE_MODERATOR")),j(b.roles.includes("ROLE_ADMIN"))):(r(!1),j(!1)),f.on("logout",(function(){O()})),function(){f.remove("logout")}}),[b,O]),Object(S.jsx)(o.a,{history:K,children:Object(S.jsxs)("div",{children:[Object(S.jsxs)("nav",{className:"navbar navbar-expand navbar-dark bg-dark",children:[Object(S.jsx)(o.c,{to:"/",className:"navbar-brand",children:"Full-stack"}),Object(S.jsxs)("div",{className:"navbar-nav mr-auto",children:[Object(S.jsx)("li",{className:"nav-item",children:Object(S.jsx)(o.c,{to:"/home",className:"nav-link",children:"Home"})}),n&&Object(S.jsx)("li",{className:"nav-item",children:Object(S.jsx)(o.c,{to:"/mod",className:"nav-link",children:"Moderator Board"})}),d&&Object(S.jsx)("li",{className:"nav-item",children:Object(S.jsx)(o.c,{to:"/admin",className:"nav-link",children:"Admin Board"})}),b&&Object(S.jsx)("li",{className:"nav-item",children:Object(S.jsx)(o.c,{to:"/user",className:"nav-link",children:"User"})})]}),b?Object(S.jsxs)("div",{className:"navbar-nav ml-auto",children:[Object(S.jsx)("li",{className:"nav-item",children:Object(S.jsx)(o.c,{to:"/profile",className:"nav-link",children:b.username})}),Object(S.jsx)("li",{className:"nav-item",children:Object(S.jsx)("a",{href:"/login",className:"nav-link",onClick:O,children:"LogOut"})})]}):Object(S.jsxs)("div",{className:"navbar-nav ml-auto",children:[Object(S.jsx)("li",{className:"nav-item",children:Object(S.jsx)(o.c,{to:"/login",className:"nav-link",children:"Login"})}),Object(S.jsx)("li",{className:"nav-item",children:Object(S.jsx)(o.c,{to:"/register",className:"nav-link",children:"Sign Up"})})]})]}),Object(S.jsx)("div",{className:"container mt-3",children:Object(S.jsxs)(l.d,{children:[Object(S.jsx)(l.b,{exact:!0,path:["/","/home"],component:E}),Object(S.jsx)(l.b,{exact:!0,path:"/login",component:J}),Object(S.jsx)(l.b,{exact:!0,path:"/register",component:W}),Object(S.jsx)(l.b,{exact:!0,path:"/profile",component:V}),Object(S.jsx)(l.b,{path:"/user",component:T}),Object(S.jsx)(l.b,{path:"/mod",component:y}),Object(S.jsx)(l.b,{path:"/admin",component:k})]})})]})})},G=n(59),Q=n(6),X={getAll:function(){return g.get("/tutorials")},get:function(e){return g.get("/tutorials/".concat(e))},create:function(e){return g.post("/tutorials",e)},update:function(e,t){return g.put("/tutorials/".concat(e),t)},remove:function(e){return g.delete("/tutorials/".concat(e))},removeAll:function(){return g.delete("/tutorials")},findByTitle:function(e){return g.get("/tutorials?title=".concat(e))}},Y=Object(u.b)("tutorials/create",function(){var e=Object(R.a)(B.a.mark((function e(t){var n,a,r;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.title,a=t.description,e.next=3,X.create({title:n,description:a});case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Z=Object(u.b)("tutorials/retrieve",Object(R.a)(B.a.mark((function e(){var t;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,X.getAll();case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})))),$=Object(u.b)("tutorials/update",function(){var e=Object(R.a)(B.a.mark((function e(t){var n,a,r;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.id,a=t.data,e.next=3,X.update(n,a);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),ee=Object(u.b)("tutorials/delete",function(){var e=Object(R.a)(B.a.mark((function e(t){var n;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.id,e.next=3,X.remove(n);case 3:return e.abrupt("return",{id:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),te=Object(u.b)("tutorials/deleteAll",Object(R.a)(B.a.mark((function e(){var t;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,X.removeAll();case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})))),ne=Object(u.b)("tutorials/findByTitle",function(){var e=Object(R.a)(B.a.mark((function e(t){var n,a;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.title,e.next=3,X.findByTitle(n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),ae={auth:D,message:O,tutorials:Object(u.c)({name:"tutorial",initialState:[],extraReducers:(N={},Object(A.a)(N,Y.fulfilled,(function(e,t){e.push(t.payload)})),Object(A.a)(N,Z.fulfilled,(function(e,t){return Object(Q.a)(t.payload)})),Object(A.a)(N,$.fulfilled,(function(e,t){var n=e.findIndex((function(e){return e.id===t.payload.id}));e[n]=Object(G.a)(Object(G.a)({},e[n]),t.payload)})),Object(A.a)(N,ee.fulfilled,(function(e,t){var n=e.findIndex((function(e){return e.id===t.payload.id}));e.splice(n,1)})),Object(A.a)(N,te.fulfilled,(function(e,t){return[]})),Object(A.a)(N,ne.fulfilled,(function(e,t){return Object(Q.a)(t.payload)})),N)}).reducer},re=Object(u.a)({reducer:ae,devTools:!0});s.a.render(Object(S.jsx)(c.a,{store:re,children:Object(S.jsx)(o.b,{basename:"/#",children:Object(S.jsx)(z,{})})}),document.getElementById("root"))}},[[228,1,2]]]);
//# sourceMappingURL=main.0d81b73f.chunk.js.map